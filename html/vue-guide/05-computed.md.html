<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.25.0/themes/prism.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.13.2/dist/style.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@6.7.0"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.13.2"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.13.2/dist/index.umd.min.js"></script><script>(r => {
          setTimeout(r);
        })(() => {
  const {
    markmap,
    mm
  } = window;
  const toolbar = new markmap.Toolbar();
  toolbar.attach(mm);
  const el = toolbar.render();
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root, jsonOptions) => {
        const markmap = getMarkmap();
        window.mm = markmap.Markmap.create('svg#mindmap', getOptions == null ? void 0 : getOptions(markmap, jsonOptions), root);
      })(() => window.markmap,(markmap, jsonOptions) => markmap.deriveOptions(jsonOptions),{"type":"heading","depth":1,"payload":{"lines":[0,1]},"content":"算出プロパティとウォッチャー","children":[{"type":"heading","depth":2,"payload":{"lines":[2,3]},"content":"算出プロパティ","children":[{"type":"bullet_list","depth":3,"payload":{"lines":[3,6]},"content":"","children":[{"type":"list_item","depth":4,"payload":{"lines":[3,4]},"content":"テンプレート内での JavaScript 式はシンプルな操作のために使う"},{"type":"list_item","depth":4,"payload":{"lines":[4,5]},"content":"リアクティブなデータを含む複雑なロジックは算出プロパティを使うべき"}]},{"type":"heading","depth":3,"payload":{"lines":[6,7]},"content":"基本的な例","children":[{"type":"list_item","depth":5,"payload":{"lines":[7,12]},"content":"<pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>#computed-basic<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span><span class=\"token punctuation\">></span></span>{{ publishedBooksMessage }}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n</code></pre>\n"},{"type":"list_item","depth":5,"payload":{"lines":[12,22]},"content":"<pre class=\"language-js\"><code class=\"language-js\">Vue<span class=\"token punctuation\">.</span><span class=\"token function\">createApp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token function\">data</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">computed</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">publishedBooksMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>author<span class=\"token punctuation\">.</span>book<span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">?</span> <span class=\"token string\">'Yes'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'No'</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#computed-basic'</span><span class=\"token punctuation\">)</span>\n</code></pre>\n"},{"type":"list_item","depth":5,"payload":{"lines":[22,23]},"content":"<code>publishedBooksMessage</code> という算出プロパティを宣言している"},{"type":"list_item","depth":5,"payload":{"lines":[23,24]},"content":"算出 getter関数とも言う"},{"type":"list_item","depth":5,"payload":{"lines":[24,25]},"content":"<code>vm.author.book</code> が変更されると、<code>vm.publishedBooksMessage</code> も更新される"},{"type":"list_item","depth":5,"payload":{"lines":[25,26]},"content":"依存関係を宣言的に作成できる","children":[{"type":"list_item","depth":7,"payload":{"lines":[26,27]},"content":"宣言的とは？","children":[{"type":"list_item","depth":9,"payload":{"lines":[27,28]},"content":"<a href=\"https://qiita.com/Hiroyuki_OSAKI/items/f3f88ae535550e95389d#%E7%A7%81%E3%81%8C%E4%B8%80%E7%95%AA%E7%90%86%E8%A7%A3%E3%81%A7%E3%81%8D%E3%81%9F%E8%AA%AC%E6%98%8E\">引用元</a>"},{"type":"list_item","depth":9,"payload":{"lines":[28,33]},"content":"<pre class=\"language-plaintext\"><code class=\"language-plaintext\">Declarativeなプログラムの場合、「コーヒー頂戴」と言うだけです。\nコーヒーの作り方は言わないで、「コーヒー頂戴」と一言で済ます。\n「目的を一言（一文）で表す 」\n</code></pre>\n"}]}]},{"type":"list_item","depth":5,"payload":{"lines":[33,34]},"content":"算出 getter関数には副作用がないのでテストが書きやすい","children":[{"type":"list_item","depth":7,"payload":{"lines":[34,35]},"content":"副作用とは？","children":[{"type":"list_item","depth":9,"payload":{"lines":[35,36]},"content":"<a href=\"https://ja.wikipedia.org/wiki/%E5%89%AF%E4%BD%9C%E7%94%A8_(%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0)\">引用元</a>"},{"type":"list_item","depth":9,"payload":{"lines":[36,43]},"content":"<pre class=\"language-plaintext\"><code class=\"language-plaintext\">プログラミングにおける副作用とは、\nある機能がコンピュータの (論理的な) 状態を変化させ、\nそれ以降で得られる結果に影響を与えることをいう。\n代表的な例は変数への値の代入である。\n</code></pre>\n"}]}]}]},{"type":"heading","depth":3,"payload":{"lines":[43,44]},"content":"算出プロパティ vs. メソッド","children":[{"type":"list_item","depth":5,"payload":{"lines":[44,45]},"content":"上記の <code>publishedBooksMessage</code> はメソッドとしても定義できる","children":[{"type":"list_item","depth":7,"payload":{"lines":[45,48]},"content":"<pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>{{ calculateBooksMessage() }}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n</code></pre>\n"},{"type":"list_item","depth":7,"payload":{"lines":[48,55]},"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token literal-property property\">methods</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">calculateBooksMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>author<span class=\"token punctuation\">.</span>books<span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">?</span> <span class=\"token string\">'Yes'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'No'</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n"}]},{"type":"list_item","depth":5,"payload":{"lines":[55,56]},"content":"どういう違いがあるのか？","children":[{"type":"list_item","depth":7,"payload":{"lines":[56,57]},"content":"算出プロパティはキャッシュされる","children":[{"type":"list_item","depth":9,"payload":{"lines":[57,58]},"content":"リアクティブな依存関係の一部が更新された場合のみ再評価される"},{"type":"list_item","depth":9,"payload":{"lines":[58,59]},"content":"<code>author.books</code> が変更されなければ、算出プロパティの <code>publishedBooksMessage</code> はキャッシュされた値が返される"}]},{"type":"list_item","depth":7,"payload":{"lines":[59,60]},"content":"メソッドは再レンダリングが起こる度に再計算される"}]}]},{"type":"heading","depth":3,"payload":{"lines":[61,62]},"content":"算出 Setter関数","children":[{"type":"list_item","depth":5,"payload":{"lines":[62,63]},"content":"算出プロパティはデフォルトでは getter関数のみだが、setter関数も宣言できる"},{"type":"list_item","depth":5,"payload":{"lines":[63,64]},"content":"例：","children":[{"type":"list_item","depth":7,"payload":{"lines":[64,80]},"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token literal-property property\">computed</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">fullName</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 算出 getter関数</span>\n    <span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> <span class=\"token operator\">...</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// 算出 setter関数</span>\n    <span class=\"token function\">set</span><span class=\"token punctuation\">(</span>newValue<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> names <span class=\"token operator\">=</span> newValue<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">' '</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>firstName <span class=\"token operator\">=</span> names<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>lastName <span class=\"token operator\">=</span> names<span class=\"token punctuation\">[</span>names<span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n","children":[{"type":"list_item","depth":9,"payload":{"lines":[78,79]},"content":"<code>console.log(vm.fullName)</code> とすると getter関数が呼ばれる"},{"type":"list_item","depth":9,"payload":{"lines":[79,80]},"content":"<code>vm.fullName = 'John Doe'</code> とすると setter関数が呼ばれる"}]}]}]}]},{"type":"heading","depth":2,"payload":{"lines":[82,83]},"content":"ウォッチャー","children":[{"type":"bullet_list","depth":3,"payload":{"lines":[83,115]},"content":"","children":[{"type":"list_item","depth":4,"payload":{"lines":[83,84]},"content":"多くの場合は <code>watch</code>オプションより算出プロパティが適切だが…"},{"type":"list_item","depth":4,"payload":{"lines":[84,85]},"content":"非同期処理は重い処理を実行したい場合に便利"},{"type":"list_item","depth":4,"payload":{"lines":[85,86]},"content":"ajaxライブラリや汎用ユーティリティメソッドのコレクションなどと組み合わせて使われる_"},{"type":"list_item","depth":4,"payload":{"lines":[86,87]},"content":"例：","children":[{"type":"list_item","depth":6,"payload":{"lines":[87,110]},"content":"<pre class=\"language-js\"><code class=\"language-js\">Vue<span class=\"token punctuation\">.</span><span class=\"token function\">createApp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token function\">data</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> <span class=\"token operator\">...</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">watch</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">question</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">newQuestion<span class=\"token punctuation\">,</span> oldQuestion</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>newQuestion<span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span><span class=\"token string\">'?'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getAnswer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">methods</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">getAnswer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>answer <span class=\"token operator\">=</span> <span class=\"token string\">'Thinking...'</span>\n      axios<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'...'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#watch-example'</span><span class=\"token punctuation\">)</span>\n</code></pre>\n","children":[{"type":"list_item","depth":8,"payload":{"lines":[107,108]},"content":"<code>watch</code> オプションを使うことで…","children":[{"type":"list_item","depth":10,"payload":{"lines":[108,109]},"content":"非同期処理 (APIアクセス) の実行"},{"type":"list_item","depth":10,"payload":{"lines":[109,110]},"content":"その処理を実行する条件の設定を実現できている"}]}]},{"type":"list_item","depth":6,"payload":{"lines":[110,111]},"content":"命令的なインスタンスメソッド <code>vm.$watch</code> もある","children":[{"type":"list_item","depth":8,"payload":{"lines":[111,112]},"content":"<code>deep</code> オプション"},{"type":"list_item","depth":8,"payload":{"lines":[112,113]},"content":"<code>immediate</code> オプション"},{"type":"list_item","depth":8,"payload":{"lines":[113,114]},"content":"<code>flush</code> オプション"}]}]}]},{"type":"heading","depth":3,"payload":{"lines":[115,116]},"content":"算出プロパティ vs. 監視プロパティ","children":[{"type":"list_item","depth":5,"payload":{"lines":[116,117]},"content":"多くの場合は、監視プロパティ (<code>watch</code> オプション) より、算出プロパティがベター_"},{"type":"list_item","depth":5,"payload":{"lines":[117,118]},"content":"以下の例の場合、監視プロパティの方だと命令的で冗長だが、算出プロパティの方は意図が読み取りやすい"},{"type":"list_item","depth":5,"payload":{"lines":[118,119]},"content":"例：","children":[{"type":"list_item","depth":7,"payload":{"lines":[119,129]},"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// 監視プロパティのパターン</span>\n<span class=\"token keyword\">const</span> vm <span class=\"token operator\">=</span> Vue<span class=\"token punctuation\">.</span><span class=\"token function\">createApp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token function\">data</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">firstNmae</span><span class=\"token operator\">:</span> <span class=\"token string\">'Foo'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">lastName</span><span class=\"token operator\">:</span> <span class=\"token string\">'Bar'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">fullName</span><span class=\"token operator\">:</span> <span class=\"token string\">'Foo Bar'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">watch</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">firstName</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">val</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>fullName <span class=\"token operator\">=</span> val <span class=\"token operator\">+</span> <span class=\"token string\">' '</span> <span class=\"token operator\">+</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>lastName <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">lastName</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">val</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>fullName <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>firstName <span class=\"token operator\">+</span> <span class=\"token string\">' '</span> <span class=\"token operator\">+</span> val <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#app'</span><span class=\"token punctuation\">)</span>\n</code></pre>\n"},{"type":"list_item","depth":7,"payload":{"lines":[129,138]},"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// 算出プロパティで書き換えたパターン</span>\n<span class=\"token keyword\">const</span> vm <span class=\"token operator\">=</span> Vue<span class=\"token punctuation\">.</span><span class=\"token function\">createApp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token function\">data</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">firstName</span><span class=\"token operator\">:</span> <span class=\"token string\">'Foo'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">lastName</span><span class=\"token operator\">:</span> <span class=\"token string\">'Bar'</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">computed</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">fullName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>firstName <span class=\"token operator\">+</span> <span class=\"token string\">' '</span> <span class=\"token operator\">+</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>lastName <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#app'</span><span class=\"token punctuation\">)</span>\n</code></pre>\n"}]}]}]}]},null)</script>
</body>
</html>
